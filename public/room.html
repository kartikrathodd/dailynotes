<!DOCTYPE html>
<html>
<head>
  <title>Room</title>
</head>
<body>
  <h2>Welcome to the Room</h2>
  <div id="messages"></div>

  <script src="/socket.io/socket.io.js"></script>
  <script>
    const socket = io();

    const urlParams = new URLSearchParams(window.location.search);
    const room = urlParams.get("room");

    function getOrSetUserID() {
      let userID = localStorage.getItem("userID");
      if (!userID) {
        userID = Math.random().toString(36).substr(2, 9);
        localStorage.setItem("userID", userID);
      }
      return userID;
    }

    const userID = getOrSetUserID();

    if (room) {
      socket.emit("join", { room, userID });
    }

    socket.on("message", (msg) => {
      const div = document.getElementById("messages");
      div.innerHTML += `<p>${msg}</p>`;
    });
  </script>
</body>
</html>
